{"version":3,"names":["FEATURE_OVERRIDE_ENABLED","FEATURE_SHOP","FEATURE_PCOM_SEARCH","FEATURE_SAVED_ITEMS","FEATURE_AB_TESTING","FEATURE_DEALER_SEARCH_CHINA","FEATURE_DEALER_SEARCH_OPENING_HOURS","FEATURE_SENTRY","FEATURE_SHOP_WISHLIST","WindowService","this","initialBodyStyleValues","top","position","inlineSize","overflowY","initialDocumentScrollTop","Object","defineProperty","prototype","window","location","newLocation","sessionStorage","localStorage","version","assign","PHN_HEADER_VERSION","loaded","PHN_NAVIGATION_LOADED","document","body","style","overflow","height","requestAnimationFrame","callback","createDiv","createElement","getBreakpoint","clientWidth","Math","max","documentElement","innerWidth","matchingBreakpoint","keys","breakpoint","reverse","find","foundBreakpoint","hasKey","REDIRECTED","search","includes","createIframe","id","src","iframe","display","appendChild","removeElement","_a","getElementById","remove","redirectToUrl","url","generateRandom","size","CHARSET","buffer","Uint8Array","crypto","getRandomValues","state","i","byteLength","index","length","push","join","maybeCheckMarketingConsent","handleSuccess","args","processorId","_c","_b","GlobalConsent","Processor","googleMaps","timeoutVar","mapContainer","callbacks","success","_e","_d","PCOM","globalConsent","checkConsent","_h","_g","_f","call","_j","ucPrivacyShield","_l","_k","deriveChallenge","code","NaviError","NaviErrorTypes","INVALID_INPUT","buf","ArrayBuffer","bufView","charCodeAt","subtle","digest","_m","sent","bytes","binary","String","fromCharCode","btoa","replace","hashString","text","msgUint8","TextEncoder","encode","hashBuffer","hashArray","Array","from","map","b","toString","padStart","getScrollbarWidth","scrollDiv","scrollbarWidth","offsetWidth","removeChild","Number","isNaN","concat","fetchGoogleMapsApi","apiKey","google","undefined","maps","existingScript","script","head","Promise","resolve","reject","onerror","GENERAL","onload","getNavigatorLatLong","navigator","geolocation","getCurrentPosition","_o","coords","latitude","longitude","error","message","getErrorType","getCookie","cookieName","getString","cookie","split","row","startsWith","setCookie","newValue","COOKIE_DOMAIN","Date","now","MS_IN_MONTH","toUTCString","data","lockScroll","shallowCopySpecifiedAttributesWithDefault","scrollTop","unlockScroll","entries","forEach","key","value","setProperty","camelToKebapCase","hasScrollbar","offsetHeight","innerHeight","waitForElement","parent","selector","isString","el","getHTMLElement","querySelector","observer","MutationObserver","newEl","disconnect","observe","childList","subtree","PERMISSION_DENIED","GEOLOCATION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","RETRY","windowService","Logger","VERSION","locale","init","_","log","logName","level","errorType","env","navStateStore","Environments","TEST","JSON","stringify","name","hostname","pathname","PRODUCTION","console","err","info","type","logger","FeatureToggles","featureEnvMap","_this","getEnvironment","DEFAULT_ENVIRONMENT","featureJson","features","isShopToggleActive","isFeatureEnabled","isPcomSearchToggleActive","isSavedItemsToggleActive","isABTestingToggleActive","isDealerSearchChinaEnabled","isDealerSearchOpeningHoursEnabled","isSentryEnabled","isShopWishlistToggleActive","loadRemoteToggles","BFFEndpoint","getConfig","BFF_ENDPOINT","fetch","response","ok","Error","json","result","err_1","stringToBooleanStrict","getUrlFeatureToggleOverride","feature","searchString","queryValue","query","getLocalStorageFeatureToggleOverride","localStorageValue","getItem","isOnSecurityLayer","enabled","featureToggleOverrides","_i","featureToggleOverrides_1","featureToggleOverride","setFeatures","error_1","prodDisabledToggles","featureToggles"],"sources":["src/utility/constants/feature-toggles.ts","src/services/window-service.ts","src/services/logger.ts","src/services/feature-toggles.ts"],"sourcesContent":["export const FEATURE_OVERRIDE_ENABLED = 'featureOverrideEnabled';\nexport const FEATURE_PORSCHE_75_YEARS_LOGO = 'porsche_75_years_logo';\nexport const FEATURE_SHOP = 'shop';\nexport const FEATURE_PCOM_SEARCH = 'pcom_search';\nexport const FEATURE_SAVED_ITEMS = 'saved_items';\nexport const FEATURE_AB_TESTING = 'ab';\n\nexport const FEATURE_DEALER_SEARCH_CHINA = 'dealer_search_china';\nexport const FEATURE_DEALER_SEARCH_OPENING_HOURS = 'opening_hours';\nexport const FEATURE_SENTRY = 'sentry';\nexport const FEATURE_SHOP_WISHLIST = 'shop_wishlist';\n","/* istanbul ignore file */\n\nimport { breakpoint } from '@porsche-design-system/components-js/styles';\nimport { LatLong } from '../entities/places';\nimport { COOKIE_DOMAIN, MS_IN_MONTH } from '../utility/constants';\nimport {\n  camelToKebapCase,\n  getHTMLElement,\n  getString,\n  hasKey,\n  isString,\n  shallowCopySpecifiedAttributesWithDefault\n} from '../utility/helper';\nimport { NaviError, NaviErrorType, NaviErrorTypes } from '../utility/navi-error';\n\ntype CheckConsent = (args: {\n  processorId: string;\n  timeoutVar: Record<string, never>;\n  mapContainer: string;\n  callbacks: {\n    success: () => void;\n  };\n}) => void;\n\nexport type MarketingWindow = Window & {\n  GlobalConsent?: { Processor?: { googleMaps?: string } };\n  PCOM?: { globalConsent?: { checkConsent?: CheckConsent } };\n  ucPrivacyShield?: { checkConsent?: CheckConsent };\n};\n\nclass WindowService {\n  get location(): Location {\n    return window.location;\n  }\n\n  set location(newLocation: Location) {\n    window.location = newLocation;\n  }\n\n  get sessionStorage(): Storage {\n    return window.sessionStorage;\n  }\n\n  get localStorage(): Storage {\n    return window.localStorage;\n  }\n\n  set version(version: string) {\n    Object.assign(window, { PHN_HEADER_VERSION: version });\n  }\n\n  set navigationLoaded(loaded: boolean) {\n    Object.assign(window, { PHN_NAVIGATION_LOADED: loaded });\n  }\n\n  get bodyOverflow(): string {\n    return document.body.style.overflow;\n  }\n\n  get bodyHeight(): string {\n    return document.body.style.height;\n  }\n\n  requestAnimationFrame(callback: FrameRequestCallback): number {\n    return window.requestAnimationFrame(callback);\n  }\n\n  createDiv() {\n    return window.document.createElement('div');\n  }\n\n  getBreakpoint(): number {\n    const clientWidth = Math.max(window.document.documentElement.clientWidth, window.innerWidth || 0);\n\n    const matchingBreakpoint = Object.keys(breakpoint)\n      .reverse()\n      .find((foundBreakpoint) => hasKey(breakpoint, foundBreakpoint) && clientWidth >= breakpoint[foundBreakpoint]);\n\n    return typeof matchingBreakpoint === 'string' && hasKey(breakpoint, matchingBreakpoint)\n      ? breakpoint[matchingBreakpoint]\n      : 0;\n  }\n\n  get redirected(): boolean {\n    return (\n      (window as Window & { REDIRECTED?: boolean }).REDIRECTED === true ||\n      window.location.search.includes('cs_redirect=')\n    );\n  }\n\n  createIframe(id: string, src: string) {\n    const iframe = window.document.createElement('iframe');\n    iframe.id = id;\n    iframe.style.display = 'none';\n    iframe.src = src;\n\n    window.document.body.appendChild(iframe);\n  }\n\n  removeElement(id: string) {\n    window.document.getElementById(id)?.remove();\n  }\n\n  redirectToUrl(url: string) {\n    window.location.assign(url);\n  }\n\n  generateRandom(size: number): string {\n    const CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n    const buffer = new Uint8Array(size);\n\n    window.crypto.getRandomValues(buffer);\n\n    const state: string[] = [];\n    for (let i = 0; i < buffer.byteLength; i += 1) {\n      const index = buffer[i] % CHARSET.length;\n      state.push(CHARSET[index]);\n    }\n\n    return state.join('');\n  }\n\n  /**\n   * site does NOT have consent mechanism -> consent NOT needed\n   * site does have consent mechanism + isConsentActive NOT exists -> consent NOT needed\n   * site does have consent mechanism + isConsentActive exists + isConsentActive -> consent needed\n   * site does have consent mechanism + NOT isConsentActive -> consent NOT needed\n   */\n\n  /**\n   * consent needed + consent given -> userConsent = true\n   * consent needed + consent NOT given -> userConsent = false\n   * consent NOT needed -> userConsent = true\n   */\n  maybeCheckMarketingConsent(handleSuccess: () => void): boolean {\n    const args = {\n      processorId: (window as MarketingWindow).GlobalConsent?.Processor?.googleMaps ?? 'Google Maps',\n      timeoutVar: {},\n      mapContainer: '',\n      callbacks: {\n        success: handleSuccess\n      }\n    };\n\n    if (typeof (window as MarketingWindow).PCOM?.globalConsent?.checkConsent === 'function') {\n      (window as MarketingWindow).PCOM?.globalConsent?.checkConsent?.(args);\n      return true;\n    }\n\n    if (typeof (window as MarketingWindow).ucPrivacyShield?.checkConsent === 'function') {\n      (window as MarketingWindow).ucPrivacyShield?.checkConsent?.(args);\n      return true;\n    }\n\n    handleSuccess();\n    return false;\n  }\n\n  async deriveChallenge(code: string): Promise<string> {\n    if (code.length < 43 || code.length > 128) {\n      throw new NaviError('invalid code length', NaviErrorTypes.INVALID_INPUT);\n    }\n\n    const buf = new ArrayBuffer(code.length);\n    const bufView = new Uint8Array(buf);\n\n    for (let i = 0; i < code.length; i++) {\n      bufView[i] = code.charCodeAt(i);\n    }\n\n    const buffer = await window.crypto.subtle.digest('SHA-256', bufView);\n\n    const bytes = new Uint8Array(buffer);\n\n    let binary = '';\n    for (let i = 0; i < bytes.byteLength; i++) {\n      binary += String.fromCharCode(bytes[i]);\n    }\n\n    return window.btoa(binary).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n  }\n\n  async hashString(text: string): Promise<string> {\n    const msgUint8 = new TextEncoder().encode(text);\n    const hashBuffer = await window.crypto.subtle.digest('SHA-256', msgUint8);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n  }\n\n  getScrollbarWidth(): string {\n    const scrollDiv = window.document.createElement('div');\n    scrollDiv.style.overflow = 'scroll';\n    window.document.body.appendChild(scrollDiv);\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n    window.document.body.removeChild(scrollDiv);\n\n    return Number.isNaN(scrollbarWidth) ? '0px' : `${scrollbarWidth}px`;\n  }\n\n  async fetchGoogleMapsApi(\n    apiKey: string,\n    url = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places`\n  ): Promise<typeof google> {\n    if (window.google !== undefined && window.google.maps !== undefined && window.google.maps.version !== undefined) {\n      return window.google;\n    }\n\n    const existingScript = document.getElementById('googleMaps'); // -> Current name?!\n\n    if (existingScript) {\n      return window.google;\n    }\n\n    const script = document.createElement('script');\n    script.src = url;\n    script.id = 'googleMaps';\n    document.head.appendChild(script);\n\n    return new Promise((resolve, reject) => {\n      script.onerror = () => {\n        reject(new NaviError('Failed to load google maps script.', NaviErrorTypes.GENERAL));\n      };\n      script.onload = () => {\n        resolve(window.google);\n      };\n    });\n  }\n\n  async getNavigatorLatLong(): Promise<LatLong> {\n    return new Promise((resolve, reject) => {\n      window.navigator.geolocation.getCurrentPosition(\n        ({ coords: { latitude, longitude } }) => {\n          resolve({ latitude, longitude });\n        },\n        (error) =>\n          reject(\n            new NaviError(\n              `geolocation.getCurrentPosition failed with ${error.code}: ${error.message}`,\n              getErrorType(error)\n            )\n          )\n      );\n    });\n  }\n\n  getCookie(cookieName: string): string {\n    return getString(\n      document.cookie\n        .split('; ')\n        .find((row) => row.startsWith(`${cookieName}=`))\n        ?.split('=')[1]\n    );\n  }\n\n  setCookie(cookieName: string, newValue: string): void {\n    document.cookie = `${cookieName}=${newValue};domain=${COOKIE_DOMAIN};expires=${new Date(\n      Date.now() + MS_IN_MONTH * 10\n    ).toUTCString()};`;\n  }\n\n  btoa(data: string) {\n    return window.btoa(data);\n  }\n\n  private initialBodyStyleValues = {\n    top: '',\n    position: '',\n    inlineSize: '',\n    overflowY: ''\n  } as const;\n  private initialDocumentScrollTop = 0;\n\n  lockScroll() {\n    this.initialBodyStyleValues = shallowCopySpecifiedAttributesWithDefault(\n      document.body.style,\n      this.initialBodyStyleValues\n    );\n    this.initialDocumentScrollTop = document.documentElement.scrollTop;\n\n    document.body.style.top = `-${document.documentElement.scrollTop}px`;\n    document.body.style.position = 'fixed';\n    document.body.style.inlineSize = '100%';\n    document.body.style.overflowY = 'scroll';\n  }\n\n  unlockScroll() {\n    Object.entries(this.initialBodyStyleValues).forEach(([key, value]) =>\n      document.body.style.setProperty(camelToKebapCase(key), value)\n    );\n\n    document.documentElement.scrollTop = this.initialDocumentScrollTop;\n  }\n\n  hasScrollbar(): boolean {\n    return window.document.body.offsetHeight > window.innerHeight;\n  }\n\n  async waitForElement(parent: HTMLElement, selector?: string): Promise<HTMLElement> {\n    if (!isString(selector)) {\n      return parent;\n    }\n\n    const el = getHTMLElement(parent.querySelector(selector));\n    if (el !== null) {\n      return el;\n    }\n    return new Promise((resolve) => {\n      const observer = new MutationObserver(() => {\n        const newEl = getHTMLElement(parent.querySelector(selector));\n        if (newEl !== null) {\n          resolve(newEl);\n          observer.disconnect();\n        }\n      });\n\n      observer.observe(parent, { childList: true, subtree: true });\n    });\n  }\n}\n\ninterface GeolocationPositionError {\n  code: number;\n  message: string;\n  PERMISSION_DENIED: number;\n  POSITION_UNAVAILABLE: number;\n  TIMEOUT: number;\n}\n\nexport function getErrorType(error: GeolocationPositionError): NaviErrorType {\n  switch (error.code) {\n    case error.PERMISSION_DENIED: {\n      return NaviErrorTypes.GEOLOCATION_DENIED;\n    }\n    case error.POSITION_UNAVAILABLE:\n    case error.TIMEOUT: {\n      return NaviErrorTypes.RETRY;\n    }\n    default: {\n      return NaviErrorTypes.GENERAL;\n    }\n  }\n}\n\nexport default new WindowService();\n","import { Environments } from '../entities/environment';\nimport { VERSION } from '../utility/constants';\nimport { NaviError, NaviErrorType, NaviErrorTypes } from '../utility/navi-error';\nimport windowService from './window-service';\n// import { captureNaviException } from './monitoring';\nimport { navStateStore } from '../state/nav-state-store';\n\nexport const LOGGING_ENDPOINT = 'https://logs.nav.porsche.com';\n\nconst enum LogLevel {\n  DEBUG = 'debug',\n  INFO = 'info',\n  ERROR = 'error'\n}\n\nclass Logger {\n  private version = VERSION;\n  private breakpoint = 0;\n  private locale: string | null = null;\n\n  init(_: number, locale: string) {\n    this.breakpoint = windowService.getBreakpoint();\n    this.locale = locale;\n  }\n\n  private log(logName: string, level: LogLevel, id: string, message: string, errorType?: NaviErrorType) {\n    const { env } = navStateStore.state;\n    if (env === Environments.TEST) {\n      return;\n    }\n\n    try {\n      const log = JSON.stringify({\n        name: logName,\n        level: level,\n        env: env,\n        breakpoint: this.breakpoint,\n        locale: this.locale,\n        version: this.version,\n        hostname: windowService.location.hostname,\n        pathname: windowService.location.pathname,\n        id,\n        errorType: errorType || '',\n        message\n      });\n\n      if (env !== Environments.PRODUCTION) {\n        // eslint-disable-next-line no-console\n        console[level](log);\n      }\n      // eslint-disable-next-line no-empty\n    } catch (err) {}\n  }\n\n  info(id: string, message = '') {\n    this.log('PHN_HEADER_LOG_ENTRY', LogLevel.INFO, id, message);\n  }\n\n  error(id: string, err: Error) {\n    const errorType = err instanceof NaviError ? err.type : NaviErrorTypes.GENERAL;\n    this.log('PHN_HEADER_LOG_ENTRY', LogLevel.ERROR, id, err.message, errorType);\n    // captureNaviException(err, { breakpoint: this.breakpoint, locale: this.locale });\n  }\n}\n\nexport default new Logger();\n","import { Environment, Environments, getEnvironment } from '../entities/environment';\nimport featureJson from '../feature-toggles.json';\nimport {\n  DEFAULT_ENVIRONMENT,\n  FEATURE_AB_TESTING,\n  FEATURE_DEALER_SEARCH_CHINA,\n  FEATURE_DEALER_SEARCH_OPENING_HOURS,\n  FEATURE_OVERRIDE_ENABLED,\n  FEATURE_PCOM_SEARCH,\n  FEATURE_SAVED_ITEMS,\n  FEATURE_SENTRY,\n  FEATURE_SHOP,\n  FEATURE_SHOP_WISHLIST\n} from '../utility/constants';\nimport { getConfig, isString } from '../utility/helper';\nimport { NaviError, NaviErrorTypes } from '../utility/navi-error';\nimport logger from './logger';\nimport windowService from './window-service';\n\ntype FeatureMap = { [featureName: string]: { enabled: boolean } };\n\nexport class FeatureToggles {\n  features: FeatureMap = {};\n  env: Environment = 'local';\n\n  constructor(\n    env = getEnvironment(DEFAULT_ENVIRONMENT),\n    private readonly featureEnvMap: { [env: string]: FeatureMap } = featureJson\n  ) {\n    this.env = env;\n    this.features = this.featureEnvMap[env];\n  }\n\n  private async loadRemoteToggles(): Promise<void> {\n    try {\n      const BFFEndpoint = getConfig(this.env).BFF_ENDPOINT;\n\n      const response = await fetch(`${BFFEndpoint}/toggles?env=${this.env}`);\n\n      if (!response.ok) {\n        const text = await response.text();\n        throw new Error(text);\n      }\n\n      const result = await response.json();\n\n      this.features = result;\n    } catch (err) {\n      throw new NaviError(`Load Feature Toggles failed with error: ${err}`, NaviErrorTypes.GENERAL);\n    }\n  }\n\n  private stringToBooleanStrict(value: string): boolean | null {\n    if (value === 'true') {\n      return true;\n    }\n    if (value === 'false') {\n      return false;\n    }\n    return null;\n  }\n\n  private getUrlFeatureToggleOverride(feature: string, searchString: string): boolean | null {\n    const queryValue = searchString\n      .split('?')[1]\n      ?.split('&')\n      .find((query) => query.includes(feature))\n      ?.split('=')[1];\n\n    return isString(queryValue) ? this.stringToBooleanStrict(queryValue || '') : null;\n  }\n\n  private getLocalStorageFeatureToggleOverride(feature: string): boolean | null {\n    const localStorageValue = localStorage.getItem(`phn.${feature}`);\n\n    return isString(localStorageValue) ? this.stringToBooleanStrict(localStorageValue) : null;\n  }\n\n  isFeatureEnabled(feature: string, searchString: string): boolean {\n    if (this.features === undefined) {\n      return false;\n    }\n\n    if (this.env === Environments.PRODUCTION && this.isOnSecurityLayer(feature)) {\n      return false;\n    }\n\n    if (this.features[FEATURE_OVERRIDE_ENABLED]?.enabled) {\n      const featureToggleOverrides = [\n        this.getUrlFeatureToggleOverride(feature, searchString),\n        this.getLocalStorageFeatureToggleOverride(feature)\n      ];\n\n      for (const featureToggleOverride of featureToggleOverrides) {\n        if (featureToggleOverride !== null) {\n          return featureToggleOverride;\n        }\n      }\n    }\n\n    if (this.features[feature] !== undefined) {\n      return this.features[feature].enabled;\n    } else {\n      return false;\n    }\n  }\n\n  async setFeatures(env: Environment): Promise<void> {\n    this.env = env;\n    try {\n      if (env === 'test') {\n        this.features = this.featureEnvMap[env];\n        return;\n      }\n      await this.loadRemoteToggles();\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    } catch (error: any) {\n      logger.error('INIT_APP_CONFIG', error);\n      this.features = this.featureEnvMap[env];\n    }\n  }\n\n  isOnSecurityLayer(feature: string): boolean {\n    const prodDisabledToggles = [FEATURE_SENTRY, FEATURE_DEALER_SEARCH_OPENING_HOURS];\n    return prodDisabledToggles.includes(feature);\n  }\n\n  isShopToggleActive = (): boolean => this.isFeatureEnabled(FEATURE_SHOP, windowService.location.search);\n  isPcomSearchToggleActive = (): boolean => this.isFeatureEnabled(FEATURE_PCOM_SEARCH, windowService.location.search);\n  isSavedItemsToggleActive = (): boolean => this.isFeatureEnabled(FEATURE_SAVED_ITEMS, windowService.location.search);\n  isABTestingToggleActive = (): boolean => this.isFeatureEnabled(FEATURE_AB_TESTING, windowService.location.search);\n  isDealerSearchChinaEnabled = (): boolean =>\n    this.isFeatureEnabled(FEATURE_DEALER_SEARCH_CHINA, windowService.location.search);\n  isDealerSearchOpeningHoursEnabled = (): boolean =>\n    this.isFeatureEnabled(FEATURE_DEALER_SEARCH_OPENING_HOURS, windowService.location.search);\n  isSentryEnabled = (): boolean => this.isFeatureEnabled(FEATURE_SENTRY, windowService.location.search);\n  isShopWishlistToggleActive = (): boolean =>\n    this.isFeatureEnabled(FEATURE_SHOP_WISHLIST, windowService.location.search);\n}\n\nexport default new FeatureToggles();\n"],"mappings":"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"}