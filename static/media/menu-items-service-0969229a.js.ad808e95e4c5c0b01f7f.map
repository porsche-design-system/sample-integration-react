{"version":3,"names":["getLevel1Items","content","dealerSearchResults","locale","loggedInState","unreadMessagesCount","userConsentGiven","dealer","models","myPorsche","vehiclePurchase","shop","experience","services","savedDealerCookie","ppnDealers","app","navStateStore","state","savedDealer","id","undefined","outboundLink","search","_a","link","dealerRoutingKeys","RoutingKeys","DEALER_SEARCH","_b","dealerSearchResultsStore","results","length","push","getDealerDetailsRoutingKey","ppnDealer","menu","elementId","MODELS","routingKeys","analyticsId","text","VEHICLE_PURCHASE","SERVICES","EXPERIENCE","dealerSearch","iconRight","shopItem","SHOP","Application","datalayerEventAction","EventActions","NAVIGATION_LINK_CLICK","splice","isDealerSearchEnabled","savedDealerName","splitLocale","language","name","isString","nameLocalized","subtext","map","onClick","isLoggedIn","IsLoggedIn","username","getUsername","loggedInFallback","MY_PORSCHE","showIconModifier","getSideDrawerItems","activeRoutingKey","topLevelRoutingKey","findTopLevelRoutingKey","series","modelsSeries","getModelsRoutingKey","tags","tag","join","renderSignatures","MODEL_RANGE_CLICK","parentRoutingKey_1","removeLastRoutingSegment","menuDrawerParent","getMenuContent","children","childItem","constructRoutingKey","getSideDrawerRoutingKey","parentRoutingKey","getLastRoutingSegment","MAIN_MENU","routingKey","legacyMore","menuContent","_c","MORE","experienceName","abTestingService","executeContentChange","idOfLastRoutingSegment","findMenuItemById","country","returnDealerSearch","isCountryInOneOfRegions","featureToggles","isDealerSearchChinaEnabled","getBackButtonText","previousRoutingKey","numberOfDealers","details","backToSearch","navContentStore","getHeadlineText","SERIES","routingId_1","find","getSubtext","_d","routingId_2"],"sources":["src/services/menu-items-service.ts"],"sourcesContent":["import { Content, findMenuItemById, Series, TMenu, TShopMenu } from '../entities/content';\nimport { isCountryInOneOfRegions, splitLocale } from '../entities/locale';\nimport {\n  constructRoutingKey,\n  findTopLevelRoutingKey,\n  getDealerDetailsRoutingKey,\n  getLastRoutingSegment,\n  getModelsRoutingKey,\n  removeLastRoutingSegment,\n  RoutingKey,\n  RoutingKeys\n} from '../entities/routing-key';\nimport { DealerSearchResults, dealerSearchResultsStore } from '../state/dealer-search-results-store';\nimport { navContentStore } from '../state/nav-content-store';\nimport { navStateStore } from '../state/nav-state-store';\nimport { EventAction, EventActions } from '../utility/constants';\nimport { Application } from '../utility/constants/app';\nimport { getUsername, IsLoggedIn, isString } from '../utility/helper';\nimport featureToggles from './feature-toggles';\nimport abTestingService from './ab-testing/ab-testing-constructor-service';\n\nexport type MenuItemProps = {\n  elementId: string;\n  routingKeys: string[];\n  analyticsId: string;\n  text: string;\n  link?: string;\n  subtext?: string;\n  iconRight?: string;\n  showIconModifier?: boolean;\n  datalayerEventAction?: EventAction;\n  onClick?: () => void;\n};\n\nexport function getLevel1Items(\n  content: Content,\n  dealerSearchResults: DealerSearchResults,\n  locale: string,\n  loggedInState: string,\n  unreadMessagesCount: number,\n  userConsentGiven: boolean\n): MenuItemProps[] {\n  const { dealer, models, myPorsche, vehiclePurchase, shop, experience, services } = content;\n  const { savedDealerCookie, ppnDealers } = dealerSearchResults;\n  const { app } = navStateStore.state;\n  const savedDealer = savedDealerCookie !== null ? ppnDealers[savedDealerCookie.id] : undefined;\n\n  // outbound link needed for Singapore market\n  let outboundLink;\n  if (locale === 'en-SG' && dealer.search.outboundLink) {\n    outboundLink = dealer.search.outboundLink?.link;\n  }\n\n  const dealerRoutingKeys: string[] = [RoutingKeys.DEALER_SEARCH];\n\n  if (savedDealer !== undefined && dealerSearchResultsStore.state.results?.length != 1) {\n    dealerRoutingKeys.push(getDealerDetailsRoutingKey(savedDealer.ppnDealer.id));\n  }\n\n  const menu: MenuItemProps[] = [\n    {\n      elementId: RoutingKeys.MODELS,\n      routingKeys: [RoutingKeys.MODELS],\n      analyticsId: models.id,\n      text: models.text\n    },\n    {\n      elementId: RoutingKeys.VEHICLE_PURCHASE,\n      routingKeys: [RoutingKeys.VEHICLE_PURCHASE],\n      analyticsId: vehiclePurchase.id,\n      text: vehiclePurchase.text\n    },\n    {\n      elementId: RoutingKeys.SERVICES,\n      routingKeys: [RoutingKeys.SERVICES],\n      analyticsId: services.id,\n      text: services.text\n    },\n    {\n      elementId: RoutingKeys.EXPERIENCE,\n      routingKeys: [RoutingKeys.EXPERIENCE],\n      analyticsId: experience.id,\n      text: experience.text\n    }\n  ];\n\n  const dealerSearch: MenuItemProps = {\n    elementId: RoutingKeys.DEALER_SEARCH,\n    routingKeys: dealerRoutingKeys,\n    analyticsId: dealer.id,\n    text: dealer.text,\n    link: outboundLink,\n    iconRight: locale === 'en-SG' && dealer.search.outboundLink ? 'none' : 'arrow-head-right'\n  };\n\n  if (shop !== null && shop.text !== '') {\n    const shopItem: MenuItemProps = {\n      elementId: RoutingKeys.SHOP,\n      routingKeys: [RoutingKeys.SHOP],\n      analyticsId: shop.id,\n      text: shop.text,\n      link: app !== Application.shop ? shop.link : undefined,\n      datalayerEventAction: EventActions.NAVIGATION_LINK_CLICK,\n      iconRight: 'none'\n    };\n\n    menu.splice(2, 0, shopItem);\n  }\n\n  if (isDealerSearchEnabled(locale, userConsentGiven)) {\n    const savedDealerName =\n      splitLocale(locale).language === 'en'\n        ? savedDealer?.ppnDealer.name\n        : isString(savedDealer?.ppnDealer.nameLocalized)\n        ? savedDealer?.ppnDealer.nameLocalized\n        : savedDealer?.ppnDealer.name;\n\n    if (isString(savedDealerName)) {\n      dealerSearch.subtext = savedDealerName;\n    }\n  } else {\n    dealerSearch.link = dealer.search.map.link;\n    dealerSearch.onClick = undefined;\n  }\n\n  menu.push(dealerSearch);\n\n  if (myPorsche !== null) {\n    const isLoggedIn = IsLoggedIn(loggedInState);\n    const username = isLoggedIn ? getUsername(loggedInState, myPorsche.loggedInFallback) : undefined;\n\n    menu.push({\n      elementId: RoutingKeys.MY_PORSCHE,\n      routingKeys: [RoutingKeys.MY_PORSCHE],\n      analyticsId: myPorsche.id,\n      text: myPorsche.text,\n      subtext: username,\n      showIconModifier: isLoggedIn && unreadMessagesCount > 0\n    });\n  }\n\n  return menu;\n}\n\nexport function getSideDrawerItems(\n  content: Content,\n  dealerSearchResults: DealerSearchResults,\n  locale: string,\n  loggedInState: string,\n  unreadMessagesCount: number,\n  activeRoutingKey: string,\n  userConsentGiven: boolean\n): MenuItemProps[] {\n  const topLevelRoutingKey = findTopLevelRoutingKey(activeRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case activeRoutingKey:\n      break;\n\n    case RoutingKeys.MODELS:\n      return content.models.series.map((modelsSeries) => ({\n        elementId: getModelsRoutingKey(modelsSeries.id),\n        routingKeys: [getModelsRoutingKey(modelsSeries.id)],\n        analyticsId: modelsSeries.id,\n        text: modelsSeries.name,\n        subtext: modelsSeries.tags.map((tag) => tag.text).join(' | '),\n        renderSignatures: true,\n        datalayerEventAction: EventActions.MODEL_RANGE_CLICK\n      }));\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.EXPERIENCE: {\n      const parentRoutingKey = removeLastRoutingSegment(activeRoutingKey);\n      const menuDrawerParent = getMenuContent(content, parentRoutingKey, topLevelRoutingKey);\n\n      if (menuDrawerParent !== null) {\n        return menuDrawerParent.children.map((childItem) => ({\n          elementId: constructRoutingKey(parentRoutingKey, childItem.id),\n          routingKeys: [constructRoutingKey(parentRoutingKey, childItem.id)],\n          analyticsId: childItem.id,\n          text: childItem.text,\n          link: childItem.link\n        }));\n      }\n\n      break;\n    }\n  }\n\n  return getLevel1Items(content, dealerSearchResults, locale, loggedInState, unreadMessagesCount, userConsentGiven);\n}\n\nexport function getSideDrawerRoutingKey(activeRoutingKey: string): string {\n  const topLevelRoutingKey = findTopLevelRoutingKey(activeRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case activeRoutingKey: {\n      break;\n    }\n\n    case RoutingKeys.DEALER_SEARCH: {\n      return RoutingKeys.DEALER_SEARCH;\n    }\n\n    case RoutingKeys.MODELS: {\n      return RoutingKeys.MODELS;\n    }\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.EXPERIENCE: {\n      const parentRoutingKey = removeLastRoutingSegment(activeRoutingKey);\n      return getLastRoutingSegment(parentRoutingKey);\n    }\n  }\n  return RoutingKeys.MAIN_MENU;\n}\n\nexport function getMenuContent(\n  content: Content,\n  routingKey: string,\n  topLevelRoutingKey: string\n): TMenu | TShopMenu | null {\n  const { vehiclePurchase, experience, shop, legacyMore, services } = content;\n\n  const menuContent: TMenu | undefined | null = {\n    [RoutingKeys.VEHICLE_PURCHASE]: vehiclePurchase,\n    [RoutingKeys.EXPERIENCE]: experience,\n    [RoutingKeys.SHOP]: shop,\n    [RoutingKeys.MORE]: legacyMore,\n    [RoutingKeys.SERVICES]: services\n  }[topLevelRoutingKey];\n\n  if (menuContent === undefined || menuContent === null) {\n    return null;\n  }\n  if (isString(menuContent.experienceName)) {\n    menuContent.children = abTestingService().executeContentChange(menuContent);\n  }\n\n  const idOfLastRoutingSegment: string = getLastRoutingSegment(routingKey);\n  return idOfLastRoutingSegment === topLevelRoutingKey\n    ? menuContent\n    : findMenuItemById(menuContent, idOfLastRoutingSegment);\n}\n\nexport function isDealerSearchEnabled(locale: string, userConsentGiven: boolean): boolean {\n  try {\n    const { country } = splitLocale(locale);\n    const returnDealerSearch = !isCountryInOneOfRegions(country) && userConsentGiven;\n\n    return (featureToggles.isDealerSearchChinaEnabled() || country !== 'CN') && returnDealerSearch;\n  } catch {\n    // ignore error\n  }\n  return true;\n}\n\nexport function getBackButtonText(content: Content, previousRoutingKey: string): string {\n  if (!isString(previousRoutingKey)) {\n    return '';\n  }\n\n  const topLevelRoutingKey = findTopLevelRoutingKey(previousRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case RoutingKeys.MODELS: {\n      return content.models.text;\n    }\n\n    case RoutingKeys.DEALER_SEARCH:\n      if (content.dealer.numberOfDealers === 1) {\n        return '';\n      }\n      return content.dealer.details.backToSearch;\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.MORE:\n    case RoutingKeys.EXPERIENCE: {\n      const menuContent = getMenuContent(navContentStore.state, previousRoutingKey, topLevelRoutingKey);\n\n      if (menuContent !== null) {\n        return menuContent.text;\n      }\n\n      break;\n    }\n  }\n\n  return '';\n}\n\nexport function getHeadlineText(content: Content, routingKey: string, topLevelRoutingKey: string): string {\n  const { dealer, myPorsche, models, vehiclePurchase, experience, shop, legacyMore, services } = content;\n  let menuContent: TMenu | undefined | null | Series;\n  switch (topLevelRoutingKey) {\n    case RoutingKeys.MORE:\n    case RoutingKeys.SHOP:\n    case RoutingKeys.EXPERIENCE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.VEHICLE_PURCHASE: {\n      menuContent = {\n        [RoutingKeys.VEHICLE_PURCHASE]: vehiclePurchase,\n        [RoutingKeys.EXPERIENCE]: experience,\n        [RoutingKeys.SHOP]: shop,\n        [RoutingKeys.MORE]: legacyMore,\n        [RoutingKeys.SERVICES]: services\n      }[topLevelRoutingKey];\n\n      if (menuContent === undefined) {\n        return '';\n      }\n\n      const idOfLastRoutingSegment: string = getLastRoutingSegment(routingKey);\n      return idOfLastRoutingSegment === topLevelRoutingKey\n        ? (menuContent?.text as string)\n        : (findMenuItemById(menuContent, idOfLastRoutingSegment)?.text as string);\n    }\n    case RoutingKeys.SERIES:\n    case RoutingKeys.MODELS: {\n      const routingId = getLastRoutingSegment(routingKey);\n      menuContent = models.series.find((modelsSeries) => routingId === modelsSeries.id);\n\n      return menuContent === undefined ? models.text : menuContent?.id;\n    }\n    case RoutingKeys.DEALER_SEARCH: {\n      return dealer.search.text;\n    }\n    case RoutingKeys.MY_PORSCHE: {\n      return myPorsche?.text as string;\n    }\n  }\n  return '';\n}\n\nexport function getSubtext(\n  topLevelRoutingKey?: RoutingKey,\n  activeRoutingKey?: string,\n  locale?: string\n): string | undefined {\n  const { myPorsche, models } = navContentStore.state;\n  const { loggedInState } = navStateStore.state;\n\n  if (topLevelRoutingKey === RoutingKeys.MY_PORSCHE) {\n    const isLoggedIn = IsLoggedIn(loggedInState);\n    return isLoggedIn ? getUsername(loggedInState, myPorsche?.loggedInFallback || '') : '';\n  }\n\n  if (topLevelRoutingKey === RoutingKeys.DEALER_SEARCH) {\n    const { savedDealerCookie, ppnDealers } = dealerSearchResultsStore.state;\n    const savedDealer = savedDealerCookie !== null ? ppnDealers[savedDealerCookie.id] : undefined;\n    const savedDealerName =\n      locale && splitLocale(locale).language === 'en'\n        ? savedDealer?.ppnDealer.name\n        : isString(savedDealer?.ppnDealer.nameLocalized)\n        ? savedDealer?.ppnDealer.nameLocalized\n        : savedDealer?.ppnDealer.name;\n\n    return savedDealerCookie ? savedDealerName : '';\n  }\n\n  if (topLevelRoutingKey === RoutingKeys.MODELS) {\n    if (isString(activeRoutingKey)) {\n      const routingId = getLastRoutingSegment(activeRoutingKey);\n      const menuContent = models.series.find((modelsSeries) => routingId === modelsSeries.id);\n      if (menuContent) {\n        return menuContent.tags.map((tag) => tag.text).join(' | ');\n      }\n    }\n  }\n\n  return '';\n}\n"],"mappings":"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"}