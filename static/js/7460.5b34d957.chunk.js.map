{"version":3,"file":"static/js/7460.5b34d957.chunk.js","mappings":"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","sources":["../node_modules/@porschehn/navigation/dist/esm-es5/src/services/content-service.ts","../node_modules/@porschehn/navigation/dist/esm-es5/src/state/shop-state-store.ts","../node_modules/@porschehn/navigation/dist/esm-es5/src/utility/helpers/shop-helper.ts"],"sourcesContent":["import { Content, ShopContentResponse } from '../entities/content';\nimport { isCountryInOneOfRegions, splitLocale } from '../entities/locale';\nimport { Application, ApplicationType } from '../utility/constants/app';\nimport { constructCacheKey, getConfig } from '../utility/helper';\nimport { modifyShopItemDependingOnMarket } from '../utility/helpers/shop-helper';\nimport { NaviError, NaviErrorTypes } from '../utility/navi-error';\nimport featureToggles from './feature-toggles';\n\nexport const contentCache = new Map<string, Content>();\n\nexport async function fetchContent(locale: string, app?: ApplicationType): Promise<Content> {\n  const config = getConfig(featureToggles.env);\n\n  const isShopEnabled = featureToggles.isShopToggleActive() && app === Application.shop;\n\n  const naviContentPromise = fetchNaviContent(config.CONTENT_URL, locale);\n  const shopContentPromise = isShopEnabled ? fetchShopContent(config.SHOP_CONTENT_URL, locale) : Promise.resolve(null);\n\n  const [naviContentResult, shopContentResult] = await Promise.allSettled([naviContentPromise, shopContentPromise]);\n\n  if (naviContentResult.status === 'rejected') {\n    throw naviContentResult.reason;\n  }\n\n  const naviContent = modifyShopItemDependingOnMarket(locale, app, naviContentResult.value);\n\n  const shopContent = shopContentResult.status === 'fulfilled' ? shopContentResult.value : null;\n\n  if (shopContent === null || naviContent.shop === null) {\n    return naviContent;\n  }\n\n  return {\n    ...naviContent,\n    shop: {\n      ...naviContent.shop,\n      children: shopContent.menuItems || naviContent.shop?.children || [],\n      additionalContent: shopContent.additionalContent,\n      availableLocales: naviContent.shop.availableLocales,\n      availableLocalesOnlyForShop: naviContent.shop.availableLocalesOnlyForShop\n    }\n  };\n}\n\nasync function fetchNaviContent(contentUrl: string, locale: string): Promise<Content> {\n  const { country, language } = splitLocale(locale);\n\n  const cacheKey = constructCacheKey(contentUrl, locale);\n\n  const cachedContent = contentCache.get(cacheKey);\n  if (cachedContent !== undefined) {\n    return cachedContent;\n  }\n\n  const data = await fetch(`${contentUrl}/${`${language}-${country}`}.json`, {\n    headers: {\n      'Cache-Control': 'no-cache',\n      'Content-Type': 'application/json'\n    }\n  });\n\n  if (data.status === 404) {\n    throw new NaviError(`No content for locale ${locale} found`, NaviErrorTypes.NO_RESULTS);\n  }\n\n  if (!data.ok) {\n    throw new NaviError(`Could not get content for locale ${locale}`, NaviErrorTypes.GENERAL);\n  }\n\n  const content = await data.json();\n\n  contentCache.set(cacheKey, content);\n\n  return content;\n}\n\nasync function fetchShopContent(contentUrl: string, locale: string): Promise<ShopContentResponse> {\n  const { country, language } = splitLocale(locale);\n\n  const data = await fetch(`${contentUrl}/${country.toLowerCase()}/${`${language}-${country}`}/navigation`, {\n    headers: {\n      'Content-Type': 'application/json',\n      'x-vercel-protection-bypass': 'SHOP_CONTENT_KEY'\n    }\n  });\n\n  if (data.status === 404) {\n    throw new NaviError(`No shop content for locale ${locale} found`, NaviErrorTypes.NO_RESULTS);\n  }\n\n  if (!data.ok) {\n    throw new NaviError(`Could not get shop content for locale ${locale}`, NaviErrorTypes.GENERAL);\n  }\n\n  return data.json();\n}\n\nexport function constructFlagURL(footerAssetsUrl: string, locale: string): string {\n  const { country } = splitLocale(locale);\n\n  let flag = country;\n  if (flag.includes('-') && !isCountryInOneOfRegions(flag)) {\n    flag = country.split('-')[0];\n  }\n\n  return `${footerAssetsUrl}/flags/${flag}.svg`;\n}\n\nexport async function getFlagURL(footerAssetsUrl: string, locale: string): Promise<string> {\n  try {\n    const flagURL = constructFlagURL(footerAssetsUrl, locale);\n\n    const res = await fetch(flagURL);\n\n    // Only set flagURL if flag actually exists\n    if (res.ok) {\n      return flagURL;\n    }\n  } catch (err) {\n    // ignore error\n  }\n\n  return '';\n}\n","import { createStore } from '@stencil/store';\n\nexport interface ShopInformation {\n  numberOfShoppingItems: number;\n  wishlistItemsNumber: number;\n  subTotal: string;\n}\n\nexport interface ShopStateStoreTypes {\n  wishlistItemsNumber: number;\n  numberOfShoppingItems: number;\n  shopInformation: ShopInformation;\n}\n\nexport const shopStateStore = createStore<ShopStateStoreTypes>({\n  wishlistItemsNumber: 0,\n  numberOfShoppingItems: 0,\n  shopInformation: { numberOfShoppingItems: 0, wishlistItemsNumber: 0, subTotal: '0' }\n});\n","import { Application, ApplicationType } from '../constants/app';\nimport { Content, TLink, TShopAdditionalContentMenu, TShopAuthStatus, TShopMenu } from '../../entities/content';\nimport { getUsername } from '../helper';\nimport { navStateStore } from '../../state/nav-state-store';\nimport { navContentStore } from '../../state/nav-content-store';\nimport { shopStateStore, ShopStateStoreTypes } from '../../state/shop-state-store';\n\nexport function isShopAvailable(locale: string, app: ApplicationType): boolean {\n  const shopList = navContentStore.state.shop?.availableLocales;\n  return shopList !== undefined && shopList.includes(locale) && app === Application.shop;\n}\n\nfunction logoLinksToShop(locale: string): boolean {\n  return navContentStore.state.shop?.logoLinksToShopLocales?.includes(locale) || false;\n}\n\nexport function isShopAvailableAndLogoLinksToShop(\n  locale: string,\n  app: ApplicationType,\n  shop: TShopMenu | null\n): shop is TShopMenu {\n  return isShopAvailable(locale, app) && logoLinksToShop(locale) && shop !== null;\n}\n\nexport function modifyShopItemDependingOnMarket(\n  locale: string,\n  app: ApplicationType | undefined,\n  content: Content\n): Content {\n  const { shop, externalShop } = content;\n\n  if (shop === null) return content;\n\n  if (externalShop && app !== Application.shop) {\n    return replaceShopWithExternalShop(content, shop, externalShop);\n  }\n\n  if (shopNotAvailableOnGlobalPages(shop, locale, app)) {\n    return removeShopItemFromContent(content, shop);\n  }\n\n  return content;\n}\n\nfunction replaceShopWithExternalShop(content: Content, shop: TShopMenu, externalShop: TLink): Content {\n  return {\n    ...content,\n    shop: {\n      ...shop,\n      ...externalShop\n    }\n  };\n}\n\nfunction shopNotAvailableOnGlobalPages(shop: TShopMenu, locale: string, app: ApplicationType | undefined) {\n  return (\n    !shop?.availableLocales.includes(locale) ||\n    (shop?.availableLocalesOnlyForShop.includes(locale) && app !== Application.shop)\n  );\n}\n\nfunction removeShopItemFromContent(content: Content, shop: TShopMenu) {\n  return {\n    ...content,\n    shop: {\n      ...shop,\n      text: ''\n    }\n  };\n}\n\nexport function filterWishlistItemsByAuthStatus(\n  menuItems: TShopAdditionalContentMenu[],\n  authStatusList: TShopAuthStatus[]\n): TShopAdditionalContentMenu[] {\n  return menuItems?.filter((item) => {\n    if (item.authStatus === null || item.authStatus === undefined) {\n      return authStatusList.includes(null);\n    }\n\n    return authStatusList.includes(item.authStatus);\n  });\n}\n\nexport function getAvailableShopVariables(): { wishlistItemsNumber: number; username: string } {\n  const { myPorsche } = navContentStore.state;\n  const { loggedInState } = navStateStore.state;\n  let { wishlistItemsNumber } = shopStateStore.state.shopInformation;\n\n  if (wishlistItemsNumber === 0) {\n    wishlistItemsNumber = shopStateStore.state.wishlistItemsNumber;\n  }\n\n  const username = getUsername(loggedInState, myPorsche?.loggedInFallback || '');\n\n  return { wishlistItemsNumber, username };\n}\n\nexport function loadsShopPropsOnStore(props: ShopStateStoreTypes): void {\n  shopStateStore.set('wishlistItemsNumber', props.wishlistItemsNumber);\n  shopStateStore.set('numberOfShoppingItems', props.numberOfShoppingItems);\n  shopStateStore.set('shopInformation', props.shopInformation);\n}\n\nfunction getWishlistIconName(): string {\n  const { shopInformation } = shopStateStore.state;\n  const { wishlistItemsNumber } = shopStateStore.state;\n  const wishlistNumber =\n    shopInformation.wishlistItemsNumber > 0 ? shopInformation.wishlistItemsNumber : wishlistItemsNumber;\n\n  return wishlistNumber > 0 ? 'heart-filled' : 'heart';\n}\n\nexport function getIconNameByMenuItemId(id: string): string | null {\n  const iconsGetterFunctions: Record<string, () => string> = {\n    wishlist: getWishlistIconName\n  };\n\n  const getIconName = iconsGetterFunctions[id];\n\n  if (typeof getIconName !== 'function') return null;\n\n  return getIconName();\n}\n"],"names":["contentCache","Map","fetchContent","e","t","o","getConfig","featureToggles","env","r","isShopToggleActive","Application","shop","a","n","splitLocale","country","language","constructCacheKey","undefined","i","get","fetch","concat","headers","c","l","sent","status","NaviError","NaviErrorTypes","NO_RESULTS","ok","GENERAL","json","s","set","fetchNaviContent","CONTENT_URL","toLowerCase","fetchShopContent","SHOP_CONTENT_URL","Promise","resolve","allSettled","h","reason","u","modifyShopItemDependingOnMarket","value","f","Object","assign","children","menuItems","additionalContent","availableLocales","availableLocalesOnlyForShop","getFlagURL","includes","isCountryInOneOfRegions","split","constructFlagURL","shopStateStore","createStore","wishlistItemsNumber","numberOfShoppingItems","shopInformation","subTotal","isShopAvailable","navContentStore","state","isShopAvailableAndLogoLinksToShop","logoLinksToShopLocales","logoLinksToShop","externalShop","replaceShopWithExternalShop","shopNotAvailableOnGlobalPages","text","removeShopItemFromContent","filterWishlistItemsByAuthStatus","filter","authStatus","getAvailableShopVariables","myPorsche","navStateStore","loggedInState","username","getUsername","loggedInFallback","loadsShopPropsOnStore","getWishlistIconName","getIconNameByMenuItemId","wishlist"],"sourceRoot":""}